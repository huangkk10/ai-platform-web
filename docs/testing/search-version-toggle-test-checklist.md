# 🧪 搜尋版本切換功能 - 最終測試檢查清單

## 📅 測試日期：2025-11-09

## ✅ 已完成的測試

### 1. 後端單元測試（容器內）
- [x] 模組導入測試
- [x] SectionSearchService 方法檢查
- [x] RVT Guide 資料庫連接
- [x] V1 基礎搜尋功能（3個結果，4233ms）
- [x] V2 方法名稱修正

**測試結果**：✅ 通過（見 `test_search_version_in_container.py`）

---

## 🔄 待執行的測試

### 2. 前端 UI 測試（瀏覽器）

#### 步驟 1：訪問頁面
- [ ] 打開瀏覽器訪問：http://localhost/rvt-chat
- [ ] 檢查頁面是否正常載入
- [ ] 確認無 Console 錯誤

#### 步驟 2：檢查 UI 組件
- [ ] 輸入框上方是否顯示版本切換開關？
- [ ] 預設位置是否為 V1（藍色🚀）？
- [ ] 切換開關樣式是否正確？

#### 步驟 3：Tooltip 測試
- [ ] 滑鼠移到 V1 圖標，顯示「基礎搜尋」提示？
- [ ] 滑鼠移到 V2 圖標，顯示「上下文增強搜尋」提示？
- [ ] 滑鼠移到 ⓘ 圖標，顯示完整說明？

#### 步驟 4：V1 搜尋測試
```
操作步驟：
1. 確保切換開關在 V1 位置
2. 輸入問題："如何進行 RVT 測試？"
3. 點擊發送
4. 觀察回應
```

**檢查項目**：
- [ ] 回應是否正常返回？
- [ ] 回應內容是否相關？
- [ ] 回應時間是否在 2 秒內？
- [ ] 打開 Network 面板：
  - [ ] 請求 URL：`/api/rvt-guide/chat/`
  - [ ] 請求 Body 包含：`"search_version": "v1"`
  - [ ] 回應狀態：200 OK

#### 步驟 5：V2 搜尋測試
```
操作步驟：
1. 點擊切換開關切換到 V2（綠色🧪）
2. 確認切換成功（顏色和圖標變更）
3. 輸入相同問題："如何進行 RVT 測試？"
4. 點擊發送
5. 觀察回應
```

**檢查項目**：
- [ ] 回應是否正常返回？
- [ ] 回應內容是否比 V1 更詳細？
- [ ] 回應時間是否在 3 秒內？
- [ ] 打開 Network 面板：
  - [ ] 請求 URL：`/api/rvt-guide/chat/`
  - [ ] 請求 Body 包含：`"search_version": "v2"`
  - [ ] 回應狀態：200 OK

#### 步驟 6：localStorage 持久化測試
```
操作步驟：
1. 切換到 V2
2. 刷新頁面（F5）
3. 檢查切換開關位置
```

**檢查項目**：
- [ ] 刷新後切換開關仍在 V2 位置？
- [ ] 打開瀏覽器 DevTools → Application → Local Storage
  - [ ] 找到 key：`rvt_search_version`
  - [ ] 值應該是：`"v2"`

#### 步驟 7：切換開關互動測試
- [ ] 快速多次切換 V1 ↔ V2，是否流暢？
- [ ] 切換時是否有視覺反饋（顏色變更）？
- [ ] 在載入時切換開關是否被禁用？

#### 步驟 8：V1 vs V2 對比測試

測試問題：
1. "RVT 測試流程"
2. "常見錯誤排查"
3. "工具使用方法"

**對比項目**：

| 項目 | V1 結果 | V2 結果 | 對比 |
|------|---------|---------|------|
| 回應時間 | ____秒 | ____秒 | V2 是否 < V1 的 1.5 倍？ |
| 內容長度 | ____字 | ____字 | V2 是否更詳細？ |
| 上下文資訊 | 有/無 | 有/無 | V2 是否包含更多上下文？ |
| 相關性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 評分 |

---

### 3. 錯誤處理測試

#### 場景 1：無網路連接
```
操作：斷開網路 → 發送訊息
預期：顯示錯誤提示，不崩潰
```
- [ ] 錯誤訊息是否清晰？
- [ ] 頁面是否仍可操作？

#### 場景 2：API 錯誤
```
操作：在 V2 模式下發送訊息（如果 V2 有問題）
預期：顯示錯誤，自動降級到 V1 或提示用戶
```
- [ ] 錯誤處理是否優雅？
- [ ] 用戶是否得到明確指引？

#### 場景 3：載入中切換
```
操作：發送訊息 → 立即切換版本
預期：切換開關被禁用，無法切換
```
- [ ] 切換開關是否被禁用？
- [ ] 載入完成後是否自動啟用？

---

### 4. 跨瀏覽器測試

#### Chrome/Edge
- [ ] 功能正常
- [ ] UI 顯示正確
- [ ] 無 Console 錯誤

#### Firefox
- [ ] 功能正常
- [ ] UI 顯示正確
- [ ] 無 Console 錯誤

#### Safari (如有)
- [ ] 功能正常
- [ ] UI 顯示正確
- [ ] 無 Console 錯誤

---

### 5. 行動裝置測試（可選）

#### 響應式設計
- [ ] 在小螢幕上切換開關是否顯示正常？
- [ ] 是否可以正常操作？

---

## 📊 測試結果記錄

### V1 測試記錄

| 測試項目 | 結果 | 備註 |
|---------|------|------|
| 回應時間 | ____秒 | |
| 回應內容 | ✅/❌ | |
| Network 請求 | ✅/❌ | |
| 相關性 | ⭐⭐⭐⭐⭐ | |

### V2 測試記錄

| 測試項目 | 結果 | 備註 |
|---------|------|------|
| 回應時間 | ____秒 | |
| 回應內容 | ✅/❌ | |
| 上下文資訊 | ✅/❌ | |
| Network 請求 | ✅/❌ | |
| 相關性 | ⭐⭐⭐⭐⭐ | |

### localStorage 測試

| 操作 | 結果 | 備註 |
|------|------|------|
| 切換到 V2 | ✅/❌ | |
| 刷新頁面 | ✅/❌ | |
| 值持久化 | ✅/❌ | |

---

## 🐛 發現的問題

### 問題 1
**描述**：
**嚴重程度**：🔴 高 / 🟡 中 / 🟢 低
**重現步驟**：
**預期行為**：
**實際行為**：
**解決方案**：

### 問題 2
（如有）

---

## ✅ 測試簽收

### 開發環境測試
- **測試人員**：________________
- **測試日期**：2025-11-09
- **測試狀態**：□ 通過 / □ 部分通過 / □ 未通過
- **備註**：

### 生產環境測試（待進行）
- **測試人員**：________________
- **測試日期**：________________
- **測試狀態**：□ 通過 / □ 部分通過 / □ 未通過
- **備註**：

---

## 📝 測試建議

1. **優先測試**：
   - V1 基礎功能（最常用）
   - UI 切換互動
   - localStorage 持久化

2. **重點對比**：
   - V1 vs V2 回應差異
   - 執行時間對比
   - 內容完整性

3. **邊界測試**：
   - 載入中操作
   - 錯誤處理
   - 網路異常

4. **使用者體驗**：
   - 切換是否直觀？
   - Tooltip 說明是否清晰？
   - 回應時間是否可接受？

---

## 🎯 測試目標

**主要目標**：
✅ 功能正常工作
✅ UI 互動流暢
✅ 向後兼容無影響

**次要目標**：
✅ V1 vs V2 有明顯差異
✅ 執行時間在可接受範圍
✅ 錯誤處理優雅

**成功標準**：
- 所有核心功能測試通過
- 無致命 Bug
- 用戶體驗良好

---

## 📚 相關文檔

- 實作報告：`/docs/features/search-version-toggle-implementation-report.md`
- 完成總結：`/docs/features/search-version-toggle-completion-summary.md`
- 容器測試：`/backend/test_search_version_in_container.py`

---

**測試清單版本**：v1.0  
**創建日期**：2025-11-09  
**最後更新**：2025-11-09  
**狀態**：✅ 待執行前端測試
