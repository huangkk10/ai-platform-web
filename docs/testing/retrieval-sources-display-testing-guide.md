# å¼•ç”¨ä¾†æºé¡¯ç¤ºåŠŸèƒ½æ¸¬è©¦æŒ‡å—

## ðŸ“‹ åŠŸèƒ½æ¦‚è¿°

Protocol Assistant ç¾åœ¨æ”¯æ´é¡¯ç¤º AI å›žè¦†å¼•ç”¨çš„çŸ¥è­˜åº«ä¾†æºï¼Œç”¨æˆ¶å¯ä»¥ï¼š
1. åœ¨ AI å›žè¦†ä¸‹æ–¹çœ‹åˆ°å¼•ç”¨ä¾†æºåˆ—è¡¨
2. é»žæ“Šä»»ä½•ä¾†æºå¡ç‰‡æŸ¥çœ‹å®Œæ•´å…§å®¹
3. è¤‡è£½å¼•ç”¨å…§å®¹åˆ°å‰ªè²¼ç°¿

## ðŸŽ¯ æ¸¬è©¦ç’°å¢ƒ

- **æ¸¬è©¦é é¢**ï¼šhttp://localhost/protocol-assistant-chat
- **æ¬Šé™è¦æ±‚**ï¼šéœ€è¦ `webProtocolAssistant` æ¬Šé™
- **å…ˆæ±ºæ¢ä»¶**ï¼šDify æ‡‰ç”¨å¿…é ˆé…ç½®çŸ¥è­˜åº«ä¸¦æ­£å¸¸è¿”å›ž `metadata.retriever_resources`

## ðŸ§ª æ¸¬è©¦æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šç™»å…¥ä¸¦è¨ªå• Protocol Assistant

1. ç™»å…¥ç³»çµ±ï¼ˆéœ€è¦æœ‰ Protocol Assistant æ¬Šé™ï¼‰
2. å°Žèˆªè‡³å´é‚Šæ¬„çš„ "Protocol Assistant"
3. ç¢ºèªé é¢æ­£å¸¸è¼‰å…¥

### æ­¥é©Ÿ 2ï¼šç™¼é€æ¸¬è©¦å•é¡Œ

**æ¸¬è©¦å•é¡Œç¯„ä¾‹**ï¼ˆé€™äº›å•é¡Œæ‡‰è©²æœƒè§¸ç™¼çŸ¥è­˜åº«æª¢ç´¢ï¼‰ï¼š

```
1. "Protocol æ¸¬è©¦çš„ SOP æµç¨‹æ˜¯ä»€éº¼ï¼Ÿ"
2. "UNH-IOL çš„æ¸¬è©¦æ¨™æº–æœ‰å“ªäº›ï¼Ÿ"
3. "å¦‚ä½•é€²è¡Œ Protocol æ¸¬è©¦ï¼Ÿ"
4. "æ¸¬è©¦ç’°å¢ƒçš„è¨­ç½®æ­¥é©Ÿ"
```

### æ­¥é©Ÿ 3ï¼šé©—è­‰å¼•ç”¨ä¾†æºé¡¯ç¤º

**é æœŸçµæžœ**ï¼š

1. **AI å›žè¦†å€åŸŸ**ï¼š
   - é¡¯ç¤ºæ­£å¸¸çš„ AI å›žç­”å…§å®¹
   - å›žç­”å…§å®¹ä¸‹æ–¹é¡¯ç¤ºã€Œå¼•ç”¨ä¾†æºã€å¡ç‰‡å€åŸŸ

2. **å¼•ç”¨ä¾†æºå¡ç‰‡**ï¼š
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ðŸ“š å¼•ç”¨ä¾†æº (3)                     â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚ â”‚ ðŸ“„ UNH-IOL SOP      â­ 85%   â”‚  â”‚  â† å¯é»žæ“Š
   â”‚ â”‚ å…§å®¹å¯åƒè€ƒç™¼é€è€…æ ¸å°...       â”‚  â”‚
   â”‚ â”‚       é»žæ“ŠæŸ¥çœ‹å®Œæ•´å…§å®¹ â†’      â”‚  â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

3. **è¦–è¦ºç‰¹å¾µ**ï¼š
   - æ·¡è—è‰²èƒŒæ™¯
   - é¡¯ç¤ºæ–‡ä»¶åç¨±å’Œç›¸ä¼¼åº¦åˆ†æ•¸
   - é¡¯ç¤ºå…§å®¹é è¦½ï¼ˆå‰ 80 å­—å…ƒï¼‰
   - Hover æ™‚å¡ç‰‡æœ‰é™°å½±æ•ˆæžœ

### æ­¥é©Ÿ 4ï¼šæ¸¬è©¦ Modal å½ˆå‡ºè¦–çª—

1. **é»žæ“Šä»»ä¸€ä¾†æºå¡ç‰‡**
2. **é©—è­‰ Modal é¡¯ç¤º**ï¼š
   - Modal æ¨™é¡Œé¡¯ç¤ºæ–‡ä»¶åç¨±å’Œç›¸ä¼¼åº¦åˆ†æ•¸
   - Metadata å€åŸŸé¡¯ç¤ºï¼š
     - çŸ¥è­˜åº«åç¨±
     - ç›¸ä¼¼åº¦åˆ†æ•¸ï¼ˆå¸¶é¡è‰²æ¨™ç±¤ï¼‰
     - ä½ç½®è³‡è¨Š
     - æ–‡ä»¶ ID å’Œç‰‡æ®µ IDï¼ˆå¦‚æžœæœ‰ï¼‰
   - å…§å®¹å€åŸŸé¡¯ç¤ºå®Œæ•´çš„å¼•ç”¨å…§å®¹ï¼ˆæ”¯æ´ Markdownï¼‰

3. **æ¸¬è©¦äº’å‹•åŠŸèƒ½**ï¼š
   - é»žæ“Šã€Œè¤‡è£½å…§å®¹ã€æŒ‰éˆ• â†’ æ‡‰è©²é¡¯ç¤ºæˆåŠŸè¨Šæ¯
   - é»žæ“Šã€Œé—œé–‰ã€æŒ‰éˆ• â†’ Modal æ‡‰è©²é—œé–‰
   - é»žæ“Šé®ç½©å€åŸŸ â†’ Modal æ‡‰è©²é—œé–‰
   - æŒ‰ ESC éµ â†’ Modal æ‡‰è©²é—œé–‰

### æ­¥é©Ÿ 5ï¼šæ¸¬è©¦é‚Šç·£æƒ…æ³

**æ¸¬è©¦æ¡ˆä¾‹ 1ï¼šç„¡å¼•ç”¨ä¾†æºçš„å›žç­”**
```
å•é¡Œï¼š"ä½ å¥½"
é æœŸï¼šé¡¯ç¤ºæç¤ºã€Œæ­¤å›žç­”åŸºæ–¼ AI çš„é€šç”¨çŸ¥è­˜ï¼Œæœªä½¿ç”¨çŸ¥è­˜åº«è³‡æ–™ã€
```

**æ¸¬è©¦æ¡ˆä¾‹ 2ï¼šå¤šå€‹å¼•ç”¨ä¾†æº**
```
å•é¡Œï¼š"Protocol æ¸¬è©¦çš„å®Œæ•´æµç¨‹"
é æœŸï¼šé¡¯ç¤ºå¤šå€‹ä¾†æºå¡ç‰‡ï¼ŒæŒ‰ç›¸ä¼¼åº¦é™åºæŽ’åˆ—
```

**æ¸¬è©¦æ¡ˆä¾‹ 3ï¼šé•·æ–‡ä»¶åç¨±**
```
é æœŸï¼šæ–‡ä»¶åç¨±è¶…é•·æ™‚æ‡‰è©²æˆªæ–·ä¸¦é¡¯ç¤ºçœç•¥è™Ÿ
```

**æ¸¬è©¦æ¡ˆä¾‹ 4ï¼šé•·å…§å®¹**
```
é æœŸï¼šModal ä¸­çš„å…§å®¹å€åŸŸæ‡‰è©²å¯ä»¥æ»¾å‹•æŸ¥çœ‹
```

## âœ… é©—è­‰æª¢æŸ¥æ¸…å–®

### å‰ç«¯é¡¯ç¤º
- [ ] å¼•ç”¨ä¾†æºå¡ç‰‡æ­£å¸¸é¡¯ç¤º
- [ ] æ–‡ä»¶åç¨±æ­£ç¢ºé¡¯ç¤º
- [ ] ç›¸ä¼¼åº¦åˆ†æ•¸æ­£ç¢ºé¡¯ç¤ºï¼ˆå¸¶é¡è‰²æ¨™ç±¤ï¼‰
- [ ] å…§å®¹é è¦½æˆªæ–·æ­£å¸¸ï¼ˆ80 å­—å…ƒï¼‰
- [ ] Hover æ•ˆæžœæ­£å¸¸ï¼ˆé™°å½±ã€ä½ç§»ï¼‰

### Modal åŠŸèƒ½
- [ ] é»žæ“Šå¡ç‰‡ Modal æ­£å¸¸å½ˆå‡º
- [ ] Modal æ¨™é¡Œæ­£ç¢º
- [ ] Metadata è³‡è¨Šå®Œæ•´
- [ ] å…§å®¹å®Œæ•´é¡¯ç¤º
- [ ] Markdown æ¸²æŸ“æ­£å¸¸
- [ ] è¤‡è£½æŒ‰éˆ•æ­£å¸¸å·¥ä½œ
- [ ] é—œé–‰æŒ‰éˆ•æ­£å¸¸å·¥ä½œ
- [ ] ESC éµé—œé–‰æ­£å¸¸
- [ ] é»žæ“Šé®ç½©é—œé–‰æ­£å¸¸

### éŸ¿æ‡‰å¼è¨­è¨ˆ
- [ ] æ¡Œé¢ç«¯é¡¯ç¤ºæ­£å¸¸ï¼ˆå¯¬åº¦ > 768pxï¼‰
- [ ] æ‰‹æ©Ÿç«¯é¡¯ç¤ºæ­£å¸¸ï¼ˆå¯¬åº¦ < 768pxï¼‰
- [ ] Modal åœ¨æ‰‹æ©Ÿç«¯å…¨èž¢å¹•é¡¯ç¤º

### æ•ˆèƒ½
- [ ] å¡ç‰‡é»žæ“Šåæ‡‰è¿…é€Ÿ
- [ ] Modal é–‹å•Ÿ/é—œé–‰å‹•ç•«æµæš¢
- [ ] ç„¡è¨˜æ†¶é«”æ´©æ¼ï¼ˆå¤šæ¬¡é–‹å•Ÿ/é—œé–‰æ¸¬è©¦ï¼‰

## ðŸ› å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### å•é¡Œ 1ï¼šå¼•ç”¨ä¾†æºä¸é¡¯ç¤º
**å¯èƒ½åŽŸå› **ï¼š
- Dify æœªè¿”å›ž `metadata.retriever_resources`
- çŸ¥è­˜åº«æœªé…ç½®æˆ– Score é–¾å€¼è¨­å®šéŽé«˜

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. æª¢æŸ¥ Dify æ‡‰ç”¨çš„çŸ¥è­˜åº«é…ç½®
2. èª¿æ•´ Score é–¾å€¼ï¼ˆå»ºè­° 0.5-0.7ï¼‰
3. æª¢æŸ¥å¾Œç«¯æ—¥èªŒï¼š`docker logs ai-django | grep metadata`

### å•é¡Œ 2ï¼šModal ç„¡æ³•æ‰“é–‹
**å¯èƒ½åŽŸå› **ï¼š
- JavaScript éŒ¯èª¤
- React çµ„ä»¶æœªæ­£ç¢ºè¼‰å…¥

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ï¼ˆF12ï¼‰
2. æŸ¥çœ‹ Console éŒ¯èª¤è¨Šæ¯
3. æª¢æŸ¥ React å‰ç«¯æ—¥èªŒ

### å•é¡Œ 3ï¼šæ¨£å¼é¡¯ç¤ºç•°å¸¸
**å¯èƒ½åŽŸå› **ï¼š
- CSS æ–‡ä»¶æœªè¼‰å…¥
- ç€è¦½å™¨å¿«å–å•é¡Œ

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. æ¸…é™¤ç€è¦½å™¨å¿«å–ï¼ˆCtrl+Shift+Deleteï¼‰
2. é‡æ–°å•Ÿå‹•å‰ç«¯å®¹å™¨ï¼š`docker compose restart react`
3. ç¢ºèª CSS æ–‡ä»¶å­˜åœ¨ï¼š
   - `SourceDetailModal.css`
   - `SourceCard.css`
   - `RetrievalSourcesDisplay.css`

## ðŸ“Š æ¸¬è©¦çµæžœè¨˜éŒ„

### æ¸¬è©¦ç’°å¢ƒè³‡è¨Š
- æ¸¬è©¦æ—¥æœŸï¼š____________________
- æ¸¬è©¦äººå“¡ï¼š____________________
- ç€è¦½å™¨ç‰ˆæœ¬ï¼š__________________
- èž¢å¹•è§£æžåº¦ï¼š__________________

### åŠŸèƒ½æ¸¬è©¦çµæžœ

| æ¸¬è©¦é …ç›® | é æœŸçµæžœ | å¯¦éš›çµæžœ | ç‹€æ…‹ | å‚™è¨» |
|---------|---------|---------|------|------|
| å¼•ç”¨ä¾†æºé¡¯ç¤º | æ­£å¸¸é¡¯ç¤º | | â˜ é€šéŽ â˜ å¤±æ•— | |
| å¡ç‰‡é»žæ“Š | æ‰“é–‹ Modal | | â˜ é€šéŽ â˜ å¤±æ•— | |
| Modal å…§å®¹ | å®Œæ•´é¡¯ç¤º | | â˜ é€šéŽ â˜ å¤±æ•— | |
| è¤‡è£½åŠŸèƒ½ | æˆåŠŸè¤‡è£½ | | â˜ é€šéŽ â˜ å¤±æ•— | |
| é—œé–‰åŠŸèƒ½ | æ­£å¸¸é—œé–‰ | | â˜ é€šéŽ â˜ å¤±æ•— | |
| éŸ¿æ‡‰å¼è¨­è¨ˆ | é©é…æ­£å¸¸ | | â˜ é€šéŽ â˜ å¤±æ•— | |
| ç„¡å¼•ç”¨æƒ…æ³ | é¡¯ç¤ºæç¤º | | â˜ é€šéŽ â˜ å¤±æ•— | |

## ðŸ” é™¤éŒ¯æŠ€å·§

### 1. æª¢æŸ¥ Dify å›žæ‡‰çµæ§‹
```javascript
// åœ¨ç€è¦½å™¨ Console ä¸­åŸ·è¡Œ
// æŸ¥çœ‹æœ€å¾Œä¸€æ¢ AI è¨Šæ¯çš„ metadata
console.log(messages[messages.length - 1].metadata);
```

### 2. æª¢æŸ¥å¼•ç”¨ä¾†æºè³‡æ–™
```javascript
// æŸ¥çœ‹ retriever_resources é™£åˆ—
console.log(messages[messages.length - 1].metadata?.retriever_resources);
```

### 3. å¼·åˆ¶é‡æ–°æ¸²æŸ“
```javascript
// å¦‚æžœå¼•ç”¨ä¾†æºæ²’æœ‰é¡¯ç¤ºï¼Œå˜—è©¦ç™¼é€æ–°è¨Šæ¯
// æˆ–é‡æ–°æ•´ç†é é¢ï¼ˆF5ï¼‰
```

### 4. æŸ¥çœ‹ç¶²è·¯è«‹æ±‚
1. æ‰“é–‹é–‹ç™¼è€…å·¥å…· â†’ Network æ¨™ç±¤
2. ç™¼é€æ¸¬è©¦å•é¡Œ
3. æŸ¥çœ‹ `/api/protocol-assistant/chat/` è«‹æ±‚çš„å›žæ‡‰
4. ç¢ºèª `metadata.retriever_resources` å­˜åœ¨

## ðŸ“ å›žå ±å•é¡Œæ ¼å¼

å¦‚æžœç™¼ç¾å•é¡Œï¼Œè«‹æŒ‰ç…§ä»¥ä¸‹æ ¼å¼å›žå ±ï¼š

```
### å•é¡Œæè¿°
[è©³ç´°æè¿°å•é¡Œç¾è±¡]

### é‡ç¾æ­¥é©Ÿ
1. [æ­¥é©Ÿ 1]
2. [æ­¥é©Ÿ 2]
3. [æ­¥é©Ÿ 3]

### é æœŸçµæžœ
[æ‡‰è©²ç™¼ç”Ÿä»€éº¼]

### å¯¦éš›çµæžœ
[å¯¦éš›ç™¼ç”Ÿä»€éº¼]

### ç’°å¢ƒè³‡è¨Š
- ç€è¦½å™¨ï¼š[Chrome / Firefox / Safari]
- ç‰ˆæœ¬ï¼š[ç‰ˆæœ¬è™Ÿ]
- ä½œæ¥­ç³»çµ±ï¼š[Windows / macOS / Linux]
- èž¢å¹•è§£æžåº¦ï¼š[1920x1080]

### éŒ¯èª¤è¨Šæ¯
[å¦‚æžœæœ‰ï¼Œè«‹è²¼ä¸Š Console éŒ¯èª¤è¨Šæ¯]

### æˆªåœ–
[å¦‚æžœæœ‰ï¼Œè«‹é™„ä¸Šæˆªåœ–]
```

## ðŸŽ‰ æ¸¬è©¦å®Œæˆ

å¦‚æžœæ‰€æœ‰æ¸¬è©¦é …ç›®éƒ½é€šéŽï¼Œä»£è¡¨å¼•ç”¨ä¾†æºé¡¯ç¤ºåŠŸèƒ½æ­£å¸¸é‹ä½œï¼

---

**æ–‡æª”ç‰ˆæœ¬**ï¼šv1.0  
**æ›´æ–°æ—¥æœŸ**ï¼š2025-10-31  
**è² è²¬äºº**ï¼šAI Platform Team
