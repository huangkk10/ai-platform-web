# ğŸ¯ æœå°‹ç‰ˆæœ¬åˆ‡æ›åŠŸèƒ½ (Search Version Toggle Feature)

## æ¦‚è¿°

ç‚º RVT Assistant å¯¦ä½œ V1/V2 æœå°‹ç‰ˆæœ¬åˆ‡æ›åŠŸèƒ½ï¼Œè®“ç”¨æˆ¶å¯ä»¥é¸æ“‡ä¸åŒçš„æœå°‹ç­–ç•¥ã€‚

- **V1 åŸºç¤æœå°‹**ï¼šå¿«é€Ÿæœå°‹ï¼Œåƒ…è¿”å›æœ€ç›¸é—œçš„æ®µè½
- **V2 ä¸Šä¸‹æ–‡å¢å¼·æœå°‹**ï¼šåŒ…å«å‰å¾Œæ®µè½ï¼Œæä¾›æ›´å®Œæ•´çš„è³‡è¨Š

## ğŸ“Š ç‹€æ…‹

| é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|
| å¾Œç«¯å¯¦ä½œ | âœ… å®Œæˆ | ViewSet API æ”¯æ´ version åƒæ•¸ |
| å‰ç«¯å¯¦ä½œ | âœ… å®Œæˆ | Hook + UI çµ„ä»¶ + æ•´åˆ |
| å®¹å™¨æ¸¬è©¦ | âœ… é€šé | V1 åŠŸèƒ½é©—è­‰æˆåŠŸ |
| UI æ¸¬è©¦ | â­ï¸ å¾…åŸ·è¡Œ | éœ€è¦ç€è¦½å™¨æ¸¬è©¦ |
| æ–‡æª” | âœ… å®Œæˆ | å¯¦ä½œå ±å‘Š + æ¸¬è©¦æ¸…å–® |

**Git åˆ†æ”¯**: `feature/search-version-toggle`  
**æœ€æ–°æäº¤**: `6ca614e` - fix(search): ä¿®æ­£ V2 æœå°‹æ–¹æ³•åç¨±éŒ¯èª¤

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å•Ÿå‹•æœå‹™
```bash
cd /home/user/codes/ai-platform-web
docker compose up -d
```

### 2. è¨ªå•æ¸¬è©¦é é¢
```
http://localhost/rvt-chat
```

### 3. æ¸¬è©¦åŠŸèƒ½
1. æª¢æŸ¥è¼¸å…¥æ¡†ä¸Šæ–¹çš„ç‰ˆæœ¬åˆ‡æ›é–‹é—œ
2. é è¨­æ‡‰è©²åœ¨ V1 ä½ç½®ï¼ˆè—è‰²ğŸš€ï¼‰
3. ç™¼é€æ¸¬è©¦è¨Šæ¯ï¼š"å¦‚ä½•é€²è¡Œ RVT æ¸¬è©¦ï¼Ÿ"
4. åˆ‡æ›åˆ° V2ï¼ˆç¶ è‰²ğŸ§ªï¼‰ä¸¦ç™¼é€ç›¸åŒå•é¡Œ
5. å°æ¯” V1 å’Œ V2 çš„å›æ‡‰å·®ç•°

## ğŸ“ é‡è¦æª”æ¡ˆ

### å¾Œç«¯
- `backend/api/views/viewsets/knowledge_viewsets.py` - ViewSet ä¿®æ”¹
- `backend/test_search_version_in_container.py` - å®¹å™¨æ¸¬è©¦è…³æœ¬

### å‰ç«¯
- `frontend/src/hooks/useRvtChat.js` - Hook ä¿®æ”¹
- `frontend/src/components/chat/SearchVersionToggle.jsx` - åˆ‡æ› UI çµ„ä»¶
- `frontend/src/components/chat/CommonAssistantChatPage.jsx` - æ•´åˆ

### æ–‡æª”
- `docs/features/search-version-toggle-implementation-report.md` - å®Œæ•´å¯¦ä½œå ±å‘Šï¼ˆ1400+ è¡Œï¼‰
- `docs/features/search-version-toggle-completion-summary.md` - å®Œæˆç¸½çµ
- `docs/testing/search-version-toggle-test-checklist.md` - æ¸¬è©¦æª¢æŸ¥æ¸…å–®

## ğŸ§ª æ¸¬è©¦

### å®¹å™¨æ¸¬è©¦ï¼ˆå·²å®Œæˆï¼‰
```bash
docker exec ai-django python /app/test_search_version_in_container.py
```

**çµæœ**ï¼š
- âœ… V1 åŸºç¤æœå°‹ï¼šæ­£å¸¸ï¼ˆ3 å€‹çµæœï¼Œ4233msï¼‰
- âœ… æ¨¡çµ„å°å…¥ï¼šæˆåŠŸ
- âœ… è³‡æ–™åº«é€£æ¥ï¼šæ­£å¸¸ï¼ˆ14 ç­† RVT Guideï¼‰

### UI æ¸¬è©¦ï¼ˆå¾…åŸ·è¡Œï¼‰
è©³è¦‹ï¼š`docs/testing/search-version-toggle-test-checklist.md`

## ğŸ¯ åŠŸèƒ½ç‰¹é»

1. **ç°¡å–®ç›´è§€**ï¼šä¸€å€‹ Switch é–‹é—œå³å¯åˆ‡æ›
2. **æŒä¹…åŒ–**ï¼šè¨˜ä½ç”¨æˆ¶é¸æ“‡ï¼ˆlocalStorageï¼‰
3. **å‘å¾Œå…¼å®¹**ï¼šä¸å½±éŸ¿å…¶ä»– Assistant
4. **è©³ç´°èªªæ˜**ï¼šTooltip æç¤ºå„ç‰ˆæœ¬ç‰¹æ€§
5. **è¼‰å…¥ä¿è­·**ï¼šè¼‰å…¥æ™‚ç¦ç”¨åˆ‡æ›

## ğŸ“Š V1 vs V2 å°æ¯”

| ç‰¹æ€§ | V1 åŸºç¤æœå°‹ | V2 ä¸Šä¸‹æ–‡æœå°‹ |
|------|-----------|-------------|
| å›æ‡‰æ™‚é–“ | ~1.5-2.0ç§’ | ~2.0-3.0ç§’ |
| è¿”å›å…§å®¹ | åƒ…åŒ¹é…æ®µè½ | åŒ¹é…æ®µè½ + ä¸Šä¸‹æ–‡ |
| é©ç”¨å ´æ™¯ | å¿«é€ŸæŸ¥æ‰¾ | æ·±å…¥ç†è§£ |
| è³‡æ–™åº«æŸ¥è©¢ | 1-2 æ¬¡ | 3-5 æ¬¡ |

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### API ç«¯é»
```
POST /api/rvt-guides/search_sections/
```

### è«‹æ±‚åƒæ•¸
```json
{
  "query": "æœå°‹æŸ¥è©¢",
  "version": "v1",  // æˆ– "v2"
  "limit": 5,
  "threshold": 0.7,
  "context_window": 1  // V2 å°ˆç”¨
}
```

### å›æ‡‰æ ¼å¼
```json
{
  "success": true,
  "version": "v1",
  "results": [...],
  "total": 3,
  "execution_time": "1500ms"
}
```

## ğŸ› å·²çŸ¥å•é¡Œ

ç„¡é‡å¤§å•é¡Œã€‚

## ğŸ“ ä¸‹ä¸€æ­¥

### ç«‹å³
- [ ] åŸ·è¡Œç€è¦½å™¨ UI æ¸¬è©¦
- [ ] é©—è­‰ V1/V2 åˆ‡æ›æ•ˆæœ
- [ ] ç¢ºèª localStorage æŒä¹…åŒ–

### çŸ­æœŸï¼ˆ1 é€±ï¼‰
- [ ] æ“´å±•åˆ° Protocol Assistant
- [ ] æ•ˆèƒ½å„ªåŒ–
- [ ] ä½¿ç”¨çµ±è¨ˆè¿½è¹¤

### ä¸­æœŸï¼ˆ1 å€‹æœˆï¼‰
- [ ] é«˜ç´šé…ç½®é¸é …
- [ ] A/B æ¸¬è©¦
- [ ] ç”¨æˆ¶åé¥‹æ”¶é›†

## ğŸ‘¥ è²¢ç»è€…

- AI Platform Development Team
- å¯¦ä½œæ—¥æœŸï¼š2025-11-09

## ğŸ“„ License

å…§éƒ¨å°ˆæ¡ˆï¼Œéµå¾ªå…¬å¸æˆæ¬Šæ”¿ç­–ã€‚

---

**æ›´æ–°æ—¥æœŸ**: 2025-11-09  
**ç‰ˆæœ¬**: v1.0.0  
**ç‹€æ…‹**: âœ… å¯¦ä½œå®Œæˆï¼Œå¾… UI é©—è­‰
