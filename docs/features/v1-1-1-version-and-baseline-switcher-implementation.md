# Dify v1.1.1 ç‰ˆæœ¬èˆ‡ Baseline åˆ‡æ›åŠŸèƒ½å¯¦æ–½å ±å‘Š

## ğŸ“‹ å°ˆæ¡ˆè³‡è¨Š

- **å¯¦æ–½æ—¥æœŸ**ï¼š2025-11-26
- **åŠŸèƒ½åç¨±**ï¼šDify äºŒéšæœå°‹ v1.1.1 ç‰ˆæœ¬ + Protocol Assistant Baseline åˆ‡æ›å™¨
- **å°ˆæ¡ˆåˆ†æ”¯**ï¼š`feature/search-version-toggle`
- **å¯¦æ–½ç‹€æ…‹**ï¼šâœ… å®Œæˆä¸¦æ¸¬è©¦é€šé

---

## ğŸ¯ å¯¦æ–½ç›®æ¨™

æ ¹æ“šç”¨æˆ¶éœ€æ±‚ï¼Œå¯¦ç¾ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **å‰µå»º v1.1.1 ç‰ˆæœ¬**ï¼šåŸºæ–¼ v1.1ï¼Œæ•´åˆå‹•æ…‹ Threshold è®€å–åŠŸèƒ½ï¼ˆåƒè€ƒ v1.2.1ï¼‰
2. **æ”¯æ´ Web UI é…ç½®è®€å–**ï¼šå¯ä»¥å¾ã€Œæœå°‹ Threshold è¨­å®šã€é é¢è®€å–å‹•æ…‹é…ç½®
3. **å¯¦ç¾ Baseline åˆ‡æ›åŠŸèƒ½**ï¼šåœ¨ Protocol Assistant Chat é é¢æ·»åŠ æŒ‰éˆ•ï¼Œè®“ç”¨æˆ¶å¯ä»¥å¿«é€Ÿåˆ‡æ›æ¼”ç®—æ³•

---

## ğŸ“Š ç‰ˆæœ¬å°æ¯”

| ç‰¹æ€§ | v1.1 (éœæ…‹) | v1.1.1 (å‹•æ…‹) | v1.2.1 (å‹•æ…‹ + Boost) |
|------|-------------|---------------|---------------------|
| **Threshold ä¾†æº** | å¯«æ­»åœ¨ç‰ˆæœ¬é…ç½® | ğŸ”„ å‹•æ…‹å¾ Web UI è®€å– | ğŸ”„ å‹•æ…‹å¾ Web UI è®€å– |
| **Title Weight** | 95%/5%, 10%/90% (å›ºå®š) | å‹•æ…‹è®€å– | å‹•æ…‹è®€å– |
| **Title Boost** | âŒ ç„¡ | âŒ ç„¡ | âœ… 15%/10% |
| **Retrieval Mode** | `two_stage` | `two_stage` | `two_stage_with_title_boost` |
| **é…ç½®å½ˆæ€§** | âŒ ä½ | âœ… é«˜ | âœ… é«˜ |
| **é©ç”¨å ´æ™¯** | å›ºå®šåƒæ•¸æ¸¬è©¦ | å¯èª¿åƒæ•¸æ¸¬è©¦ï¼ˆç´”ç²¹äºŒéšï¼‰ | æ¨™é¡ŒåŒ¹é…å„ªåŒ– |

---

## ğŸš€ å¯¦æ–½éšæ®µ

### âœ… éšæ®µä¸€ï¼šåˆ†æç¾æœ‰æ¶æ§‹å’Œéœ€æ±‚

**å®Œæˆå…§å®¹**ï¼š
- âœ… åˆ†æ v1.1ã€v1.2.1 çš„é…ç½®å·®ç•°
- âœ… ç¢ºèª Baseline åˆ‡æ›æ©Ÿåˆ¶å·²å­˜åœ¨ï¼ˆå¾Œç«¯ API å’Œå‰ç«¯é¡¯ç¤ºï¼‰
- âœ… ç¢ºèª ThresholdManager å‹•æ…‹è¼‰å…¥æ©Ÿåˆ¶

**é—œéµç™¼ç¾**ï¼š
1. å¾Œç«¯å·²æœ‰ `GET /api/dify-benchmark/versions/get_baseline/` API
2. å¾Œç«¯å·²æœ‰ `POST /api/dify-benchmark/versions/:id/set_baseline/` API
3. å‰ç«¯å·²åœ¨ `ProtocolAssistantChatPage.js` ä¸­èª¿ç”¨ `getDifyBaseline()`
4. å‰ç«¯ `difyBenchmarkApi.js` **ç¼ºå°‘** `getDifyBaseline()` æ–¹æ³•å®šç¾©ï¼ˆå·²ä¿®å¾©ï¼‰

---

### âœ… éšæ®µäºŒï¼šå‰µå»º v1.1.1 ç‰ˆæœ¬è…³æœ¬

**æ–°å¢æª”æ¡ˆ**ï¼š
- `backend/scripts/create_dify_v1_1_1_dynamic_version.py`

**æ ¸å¿ƒé…ç½®**ï¼š
```python
rag_settings = {
    "assistant_type": "protocol_assistant",
    
    "stage1": {
        "use_dynamic_threshold": True,  # âœ… å•Ÿç”¨å‹•æ…‹è¼‰å…¥
        "assistant_type": "protocol_assistant",
        "top_k": 20,
        # é è¨­å€¼ï¼ˆç•¶ DB ç„¡è¨­å®šæ™‚ä½¿ç”¨ï¼‰
        "threshold": 0.80,
        "title_weight": 95,
        "content_weight": 5,
    },
    
    "stage2": {
        "use_dynamic_threshold": True,  # âœ… å•Ÿç”¨å‹•æ…‹è¼‰å…¥
        "assistant_type": "protocol_assistant",
        "top_k": 10,
        "threshold": 0.80,
        "title_weight": 10,
        "content_weight": 90,
    },
    
    "retrieval_mode": "two_stage",  # âš ï¸ ä¸æ˜¯ two_stage_with_title_boost
    "use_backend_search": True,
    "search_service": "ProtocolGuideSearchService"
}
```

**é—œéµå·®ç•°**ï¼š
- âœ… `use_dynamic_threshold: True`ï¼ˆå¾ Web UI è®€å–ï¼‰
- âŒ **ç„¡** `title_match_bonus`ï¼ˆä¸ä½¿ç”¨ Title Boostï¼‰
- âœ… `retrieval_mode: "two_stage"`ï¼ˆç´”ç²¹äºŒéšæœå°‹ï¼‰

**åŸ·è¡Œçµæœ**ï¼š
```bash
docker exec ai-django python /app/scripts/create_dify_v1_1_1_dynamic_version.py
# âœ… æˆåŠŸå‰µå»ºç‰ˆæœ¬
```

---

### âœ… éšæ®µä¸‰ï¼šå¯¦ç¾å‰ç«¯ Baseline åˆ‡æ›æ©Ÿåˆ¶

#### 3.1 ä¿®å¾©ç¼ºå¤±çš„ API æ–¹æ³•

**ä¿®æ”¹æª”æ¡ˆ**ï¼š`frontend/src/services/difyBenchmarkApi.js`

**æ–°å¢å…§å®¹**ï¼š
```javascript
/**
 * ç²å–ç•¶å‰ Baseline ç‰ˆæœ¬
 * @returns {Promise} - åŒ…å« baseline ç‰ˆæœ¬è³‡è¨Šçš„ Promise
 */
export const getDifyBaseline = () => {
  return api.get('/api/dify-benchmark/versions/get_baseline/');
};
```

**å°å‡ºåˆ—è¡¨æ›´æ–°**ï¼š
```javascript
const difyBenchmarkApi = {
  // ...
  getDifyBaseline,  // âœ… æ–°å¢
  // ...
};
```

#### 3.2 æ·»åŠ  Baseline åˆ‡æ›åŠŸèƒ½

**ä¿®æ”¹æª”æ¡ˆ**ï¼š`frontend/src/pages/ProtocolAssistantChatPage.js`

**æ–°å¢åŠŸèƒ½**ï¼š
1. âœ… è¼‰å…¥å¯ç”¨ç‰ˆæœ¬åˆ—è¡¨
2. âœ… ã€Œåˆ‡æ› Baselineã€Dropdown æŒ‰éˆ•
3. âœ… ç‰ˆæœ¬é¸å–®ï¼ˆé¡¯ç¤ºç•¶å‰ Baselineã€å‹•æ…‹æ¨™è¨˜ï¼‰
4. âœ… åˆ‡æ›ç¢ºèªå°è©±æ¡†ï¼ˆé¡¯ç¤ºå‹•æ…‹ç‰ˆæœ¬æé†’ï¼‰
5. âœ… è‡ªå‹•åˆ·æ–° Baseline é¡¯ç¤º

**UI æ•ˆæœ**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â­ Benchmark Baseline: Dify äºŒéšæœå°‹ v1.2.1    [åˆ‡æ› Baseline] â”‚
â”‚    ğŸ”„ å‹•æ…‹ Threshold                                          â”‚
â”‚    â„¹ï¸ æ­¤é…ç½®åƒ…ç”¨æ–¼ Benchmark æ¸¬è©¦ã€‚Chat åŠŸèƒ½çš„æª¢ç´¢åƒæ•¸åœ¨...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é»æ“Šã€Œåˆ‡æ› Baselineã€å¾Œçš„é¸å–®**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dify äºŒéšæœå°‹ v1.1.1 (Dynamic Threshold) ğŸ”„  â”‚
â”‚ dify-two-tier-v1.1.1                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dify äºŒéšæœå°‹ v1.2.1 (Dynamic Threshold +   â”‚
â”‚   Title Boost) [ç•¶å‰] ğŸ”„                     â”‚
â”‚ dify-two-tier-v1.2.1                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dify äºŒéšæœå°‹ v1.2 (Title Boost)             â”‚
â”‚ dify-two-tier-v1.2                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dify äºŒéšæœå°‹ v1.1                           â”‚
â”‚ dify-two-tier-v1.1                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3 ä¿®æ­£å¾Œç«¯ API å›æ‡‰æ ¼å¼

**ä¿®æ”¹æª”æ¡ˆ**ï¼š`backend/api/views/viewsets/dify_benchmark_viewsets.py`

**ä¿®æ­£å‰**ï¼š
```python
return Response({
    'success': True,
    **data  # è³‡æ–™ç›´æ¥å±•é–‹åœ¨æ ¹å±¤ç´š
}, status=status.HTTP_200_OK)
```

**ä¿®æ­£å¾Œ**ï¼š
```python
return Response({
    'success': True,
    'baseline': data  # âœ… åŒ…è£åœ¨ baseline æ¬„ä½ä¸­
}, status=status.HTTP_200_OK)
```

**åŸå› **ï¼šå‰ç«¯æœŸæœ› `response.data.baseline` çµæ§‹

---

### âœ… éšæ®µå››ï¼šå¾Œç«¯ API æ•´åˆ

**ç¢ºèªé …ç›®**ï¼š
1. âœ… æœå°‹æœå‹™å·²ç¶“æ”¯æ´å‹•æ…‹é…ç½®å’Œ `version_config`
2. âœ… ThresholdManager å·²ç¶“èƒ½å¾è³‡æ–™åº«è®€å–é…ç½®
3. âœ… ç³»çµ±æœƒè‡ªå‹•ä½¿ç”¨æœ€æ–°çš„é…ç½®ï¼ˆ5 åˆ†é˜å¿«å– TTLï¼‰

**å·¥ä½œåŸç†**ï¼š
```
ä½¿ç”¨è€…èª¿æ•´ Web UIã€Œæœå°‹ Threshold è¨­å®šã€
           â†“
    å„²å­˜åˆ° search_threshold_settings è¡¨
           â†“
   ThresholdManager æª¢æ¸¬åˆ°éæœŸï¼ˆ5 åˆ†é˜ TTLï¼‰
           â†“
       å¾ DB é‡æ–°è¼‰å…¥é…ç½®
           â†“
   æœå°‹æœå‹™ä½¿ç”¨æ–°çš„ threshold/weights
           â†“
         æ¸¬è©¦ç«‹å³ç”Ÿæ•ˆ
```

**ç„¡éœ€é¡å¤–å¯¦æ–½**ï¼šç¾æœ‰æ¶æ§‹å·²å®Œæ•´æ”¯æ´

---

### âœ… éšæ®µäº”ï¼šæ¸¬è©¦é©—è­‰

**æ–°å¢æª”æ¡ˆ**ï¼š`tests/test_v1_1_1_integration.py`

**æ¸¬è©¦çµæœ**ï¼š
```
================================================================================
  ğŸ“Š æ¸¬è©¦ç¸½çµ
================================================================================
â„¹ï¸  ç¸½æ¸¬è©¦æ•¸: 5
âœ… é€šé: 5
âœ… ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼
```

**æ¸¬è©¦é …ç›®**ï¼š
1. âœ… é©—è­‰ v1.1.1 ç‰ˆæœ¬å­˜åœ¨
2. âœ… é©—è­‰å‹•æ…‹ Threshold è¼‰å…¥
3. âœ… é©—è­‰ Baseline API
4. âœ… é©—è­‰åˆ‡æ› Baseline åŠŸèƒ½
5. âœ… ç‰ˆæœ¬å°æ¯”ï¼ˆv1.1 vs v1.1.1 vs v1.2.1ï¼‰

**é—œéµé©—è­‰é»**ï¼š
- âœ… v1.1.1 é…ç½®ç‚ºå‹•æ…‹ç‰ˆæœ¬
- âœ… v1.1.1 ç„¡ Title Boostï¼ˆç¬¦åˆè¨­è¨ˆï¼‰
- âœ… ThresholdManager èƒ½æ­£ç¢ºè®€å–è³‡æ–™åº«é…ç½®
- âœ… ç•¶å‰æœ‰ 4 å€‹å¯ç”¨ç‰ˆæœ¬ï¼ˆv1.1, v1.1.1, v1.2, v1.2.1ï¼‰
- âœ… Baseline åˆ‡æ›é‚è¼¯é©—è­‰é€šé

---

## ğŸ“ æª”æ¡ˆè®Šæ›´æ¸…å–®

### æ–°å¢æª”æ¡ˆ
1. `backend/scripts/create_dify_v1_1_1_dynamic_version.py` - v1.1.1 ç‰ˆæœ¬å‰µå»ºè…³æœ¬
2. `tests/test_v1_1_1_integration.py` - æ•´åˆæ¸¬è©¦è…³æœ¬
3. `docs/features/v1-1-1-version-and-baseline-switcher-implementation.md` - æœ¬æ–‡æª”

### ä¿®æ”¹æª”æ¡ˆ
1. `frontend/src/services/difyBenchmarkApi.js`
   - æ–°å¢ `getDifyBaseline()` æ–¹æ³•
   - æ›´æ–°å°å‡ºåˆ—è¡¨

2. `frontend/src/pages/ProtocolAssistantChatPage.js`
   - æ–°å¢ Baseline åˆ‡æ›åŠŸèƒ½
   - æ–°å¢ç‰ˆæœ¬é¸å–® UI
   - æ–°å¢åˆ‡æ›ç¢ºèªå°è©±æ¡†

3. `backend/api/views/viewsets/dify_benchmark_viewsets.py`
   - ä¿®æ­£ `get_baseline` API å›æ‡‰æ ¼å¼

---

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### 1. å‰µå»º v1.1.1 ç‰ˆæœ¬ï¼ˆå¦‚æœå°šæœªå‰µå»ºï¼‰

```bash
docker exec ai-django python /app/scripts/create_dify_v1_1_1_dynamic_version.py
```

### 2. é©—è­‰ç‰ˆæœ¬å‰µå»ºæˆåŠŸ

```bash
docker exec ai-django python /app/tests/test_v1_1_1_integration.py
```

### 3. åœ¨ Web UI ä¸­åˆ‡æ› Baseline

**æ–¹æ³• 1ï¼šProtocol Assistant Chat é é¢**
1. æ‰“é–‹ http://localhost/protocol-chat
2. é»æ“Šé ‚éƒ¨çš„ã€Œåˆ‡æ› Baselineã€æŒ‰éˆ•
3. é¸æ“‡ã€ŒDify äºŒéšæœå°‹ v1.1.1ã€
4. ç¢ºèªåˆ‡æ›

**æ–¹æ³• 2ï¼šVSA ç‰ˆæœ¬ç®¡ç†é é¢**
1. æ‰“é–‹ http://localhost/vsa/versions
2. æ‰¾åˆ°ã€ŒDify äºŒéšæœå°‹ v1.1.1ã€
3. é»æ“Šã€Œè¨­ç‚º Baselineã€

### 4. èª¿æ•´å‹•æ…‹é…ç½®

1. é€²å…¥ã€Œæœå°‹ Threshold è¨­å®šã€é é¢
2. èª¿æ•´ Protocol Assistant åƒæ•¸ï¼š
   - Stage 1 Threshold: 80% â†’ 85%
   - Stage 1 Title Weight: 95% â†’ 90%
   - Stage 1 Content Weight: 5% â†’ 10%
3. å„²å­˜è¨­å®š
4. ç­‰å¾… 5 åˆ†é˜ï¼ˆæˆ–æ‰‹å‹•åˆ·æ–°å¿«å–ï¼‰

### 5. åŸ·è¡Œæ¸¬è©¦é©—è­‰

1. åœ¨ VSA æ‰¹é‡æ¸¬è©¦é é¢é¸æ“‡ v1.1.1 ç‰ˆæœ¬
2. åŸ·è¡Œæ¸¬è©¦
3. æŸ¥çœ‹æ¸¬è©¦çµæœä¸­çš„ `detailed_results.actual_config`
4. ç¢ºèªä½¿ç”¨äº†æœ€æ–°çš„é…ç½®

---

## ğŸ“Š å‹•æ…‹é…ç½®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        é…ç½®å„ªå…ˆé †åº                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Dify Studio é…ç½® (dify_threshold)                           â”‚
â”‚     â†“ (å¦‚æœæ²’æœ‰)                                                â”‚
â”‚  2. è³‡æ–™åº«é…ç½® (search_threshold_settings)  â† v1.1.1 ä½¿ç”¨é€™å€‹   â”‚
â”‚     â†“ (å¦‚æœæ²’æœ‰)                                                â”‚
â”‚  3. ç‰ˆæœ¬é è¨­å€¼ (rag_settings)                                   â”‚
â”‚     â†“ (å¦‚æœæ²’æœ‰)                                                â”‚
â”‚  4. ç¨‹å¼ç¢¼é è¨­å€¼ (0.7)                                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**v1.1.1 é…ç½®è·¯å¾‘**ï¼š
```
Web UIã€Œæœå°‹ Threshold è¨­å®šã€
    â†“
search_threshold_settings è¡¨ (assistant_type='protocol_assistant')
    â†“
ThresholdManager (5 åˆ†é˜å¿«å–)
    â†“
æœå°‹æœå‹™ä½¿ç”¨é…ç½®
    â†“
Benchmark æ¸¬è©¦çµæœ
```

---

## ğŸ“ ç‰ˆæœ¬é¸æ“‡å»ºè­°

### å ´æ™¯ 1ï¼šå»ºç«‹ Baseline åƒè€ƒ
**æ¨è–¦ç‰ˆæœ¬**ï¼šv1.1 (éœæ…‹)
- å›ºå®šåƒæ•¸ï¼Œçµæœç©©å®š
- é©åˆä½œç‚ºé•·æœŸ Baseline

### å ´æ™¯ 2ï¼šå¿«é€Ÿåƒæ•¸èª¿å„ª
**æ¨è–¦ç‰ˆæœ¬**ï¼šv1.1.1 (å‹•æ…‹)
- ç„¡éœ€å‰µå»ºæ–°ç‰ˆæœ¬
- å³æ™‚èª¿æ•´åƒæ•¸
- ç´”ç²¹äºŒéšæœå°‹

### å ´æ™¯ 3ï¼šæ¨™é¡ŒåŒ¹é…å„ªåŒ–
**æ¨è–¦ç‰ˆæœ¬**ï¼šv1.2.1 (å‹•æ…‹ + Title Boost)
- å‹•æ…‹åƒæ•¸èª¿æ•´
- æ¨™é¡ŒåŒ¹é…åŠ åˆ†
- é©åˆæ¨™é¡Œå°å‘æŸ¥è©¢

### å ´æ™¯ 4ï¼šA/B å°æ¯”æ¸¬è©¦
**æ¨è–¦æ–¹å¼**ï¼š
1. è¨­å®š v1.1.1 ç‚º Baseline
2. åœ¨ã€Œæœå°‹ Threshold è¨­å®šã€ä¸­èª¿æ•´åƒæ•¸çµ„ A
3. åŸ·è¡Œæ¸¬è©¦ä¸¦è¨˜éŒ„çµæœ
4. èª¿æ•´ç‚ºåƒæ•¸çµ„ B
5. å†æ¬¡åŸ·è¡Œæ¸¬è©¦ä¸¦å°æ¯”

---

## âš ï¸ æ³¨æ„äº‹é …

### 1. Baseline çš„å½±éŸ¿ç¯„åœ
- âœ… å½±éŸ¿ï¼šæ‰€æœ‰ä½¿ç”¨è©² Assistant çš„ Benchmark æ¸¬è©¦
- âŒ ä¸å½±éŸ¿ï¼šProtocol Assistant Chat åŠŸèƒ½ï¼ˆç”± Dify Studio é…ç½®ï¼‰

### 2. å‹•æ…‹é…ç½®ç”Ÿæ•ˆæ™‚é–“
- ThresholdManager æœ‰ 5 åˆ†é˜å¿«å– TTL
- ä¿®æ”¹é…ç½®å¾Œï¼Œæœ€å¤šç­‰å¾… 5 åˆ†é˜ç”Ÿæ•ˆ
- æˆ–é‡å•Ÿ Django å®¹å™¨ç«‹å³ç”Ÿæ•ˆ

### 3. v1.1.1 èˆ‡ v1.2.1 çš„é¸æ“‡
- **v1.1.1**ï¼šç´”ç²¹äºŒéšæœå°‹ï¼Œé©åˆæ¨™æº–æŸ¥è©¢
- **v1.2.1**ï¼šé¡å¤–çš„ Title Boostï¼Œé©åˆæ¨™é¡Œé—œéµå­—æ˜ç¢ºçš„æŸ¥è©¢
- å»ºè­°å…ˆæ¸¬è©¦ v1.1.1ï¼Œå¦‚æœæ•ˆæœä¸ä½³å†å˜—è©¦ v1.2.1

### 4. é…ç½®è¿½è¹¤
- æ‰€æœ‰æ¸¬è©¦çµæœéƒ½æœƒè¨˜éŒ„å¯¦éš›ä½¿ç”¨çš„é…ç½®
- æª¢æŸ¥ `detailed_results.actual_config` æ¬„ä½
- ç¢ºèªæ¸¬è©¦ä½¿ç”¨çš„ threshold/weights å€¼

---

## ğŸ” æ•…éšœæ’æŸ¥

### å•é¡Œ 1ï¼šåˆ‡æ› Baseline æŒ‰éˆ•æ²’æœ‰å‡ºç¾
**æª¢æŸ¥**ï¼š
1. ç¢ºèªå·²ç™»å…¥
2. ç¢ºèªæœ‰ Baseline ç‰ˆæœ¬å­˜åœ¨
3. é‡æ–°æ•´ç†é é¢ï¼ˆF5ï¼‰
4. æª¢æŸ¥ç€è¦½å™¨ Console æ˜¯å¦æœ‰éŒ¯èª¤

### å•é¡Œ 2ï¼šåˆ‡æ›å¾Œæ²’æœ‰ç”Ÿæ•ˆ
**æª¢æŸ¥**ï¼š
1. ç¢ºèª API å›æ‡‰æˆåŠŸï¼ˆNetwork é¢æ¿ï¼‰
2. ç¢ºèªè³‡æ–™åº«ä¸­ `is_baseline` æ¬„ä½å·²æ›´æ–°
3. åˆ·æ–°é é¢ç¢ºèªé ‚éƒ¨é¡¯ç¤ºæ–°çš„ Baseline

### å•é¡Œ 3ï¼šå‹•æ…‹é…ç½®æ²’æœ‰ç”Ÿæ•ˆ
**æª¢æŸ¥**ï¼š
1. ç¢ºèªã€Œæœå°‹ Threshold è¨­å®šã€ä¸­æœ‰ Protocol Assistant é…ç½®
2. ç¢ºèªé…ç½®çš„ `is_active` ç‚º `True`
3. ç­‰å¾… 5 åˆ†é˜æˆ–é‡å•Ÿå®¹å™¨
4. æª¢æŸ¥æ¸¬è©¦çµæœçš„ `actual_config` æ¬„ä½

### å•é¡Œ 4ï¼šv1.1.1 ç‰ˆæœ¬ä¸å­˜åœ¨
**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```bash
docker exec ai-django python /app/scripts/create_dify_v1_1_1_dynamic_version.py
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

1. **å‹•æ…‹ Threshold ç³»çµ±**
   - `docs/architecture/dynamic-threshold-system.md`

2. **Threshold Manager**
   - `library/common/threshold_manager.py`

3. **Dify é…ç½®ç®¡ç†**
   - `docs/ai-integration/dify-app-config-usage.md`

4. **æœå°‹æœå‹™æ¶æ§‹**
   - `docs/architecture/protocol-search-service-architecture.md`

5. **VSA æ¸¬è©¦ç³»çµ±**
   - `docs/features/vsa-benchmark-system.md`

---

## âœ… å¯¦æ–½ç¸½çµ

### å®Œæˆæˆæœ
1. âœ… **v1.1.1 ç‰ˆæœ¬å‰µå»º**ï¼šå‹•æ…‹é…ç½® + ç´”ç²¹äºŒéšæœå°‹
2. âœ… **å‰ç«¯ Baseline åˆ‡æ›å™¨**ï¼šä¾¿æ·çš„ UI åˆ‡æ›ç•Œé¢
3. âœ… **API æ•´åˆ**ï¼šå®Œæ•´çš„å¾Œç«¯æ”¯æ´
4. âœ… **æ¸¬è©¦é©—è­‰**ï¼š5 é …æ¸¬è©¦å…¨éƒ¨é€šé

### æŠ€è¡“äº®é»
- ğŸ¯ **é…ç½®é©…å‹•**ï¼šWeb UI èª¿æ•´ç«‹å³ç”Ÿæ•ˆ
- ğŸ”„ **å‹•æ…‹è¼‰å…¥**ï¼šThresholdManager è‡ªå‹•å¿«å–ç®¡ç†
- ğŸ¨ **å„ªé›… UI**ï¼šæ¸…æ™°çš„ç‰ˆæœ¬æ¨™è¨˜ï¼ˆå‹•æ…‹æ¨™è¨˜ã€ç•¶å‰æ¨™è¨˜ï¼‰
- ğŸ“Š **å®Œæ•´è¿½è¹¤**ï¼šæ¸¬è©¦çµæœè¨˜éŒ„å¯¦éš›é…ç½®

### ç”¨æˆ¶åƒ¹å€¼
- âš¡ **å¿«é€Ÿèª¿å„ª**ï¼šç„¡éœ€å‰µå»ºæ–°ç‰ˆæœ¬ï¼Œå³æ™‚èª¿æ•´åƒæ•¸
- ğŸ¯ **ç²¾æº–å°æ¯”**ï¼šåŒä¸€ç‰ˆæœ¬ï¼Œä¸åŒé…ç½®ï¼Œå¿«é€Ÿ A/B æ¸¬è©¦
- ğŸ”€ **éˆæ´»åˆ‡æ›**ï¼šä¸€éµåˆ‡æ›æ¼”ç®—æ³•ï¼Œæ–¹ä¾¿æ¸¬è©¦å°æ¯”
- ğŸ“ˆ **æ•¸æ“šé€æ˜**ï¼šæ¸¬è©¦çµæœå®Œæ•´è¨˜éŒ„é…ç½®ï¼Œä¾¿æ–¼è¿½è¹¤

---

## ğŸ‰ å°ˆæ¡ˆç‹€æ…‹

**âœ… æ‰€æœ‰éšæ®µå®Œæˆä¸¦æ¸¬è©¦é€šé**

**ä¸‹ä¸€æ­¥å»ºè­°**ï¼š
1. åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­é€²è¡Œä½¿ç”¨è€…é©—æ”¶æ¸¬è©¦
2. æ”¶é›†ç”¨æˆ¶å° v1.1.1 ç‰ˆæœ¬çš„åé¥‹
3. æ ¹æ“šæ¸¬è©¦çµæœèª¿æ•´é è¨­ threshold å€¼
4. è€ƒæ…®æ·»åŠ é…ç½®æ­·å²è¨˜éŒ„åŠŸèƒ½

---

**æ–‡æª”ç‰ˆæœ¬**ï¼šv1.0  
**æœ€å¾Œæ›´æ–°**ï¼š2025-11-26  
**ä½œè€…**ï¼šAI Platform Team  
**ç‹€æ…‹**ï¼šâœ… å®Œæˆ
