# Protocol Guide æ‘˜è¦å€å¡ŠåŠŸèƒ½è¦åŠƒ

## ğŸ“‹ æ–‡ä»¶è³‡è¨Š

| é …ç›® | å…§å®¹ |
|------|------|
| **åŠŸèƒ½åç¨±** | Protocol Guide æ‘˜è¦å€å¡Šï¼ˆSummary Blockï¼‰ |
| **å»ºç«‹æ—¥æœŸ** | 2025-12-08 |
| **å®Œæˆæ—¥æœŸ** | 2025-12-08 |
| **ç‹€æ…‹** | âœ… å·²å®Œæˆ |
| **ç›¸é—œé é¢** | `/knowledge/protocol-guide/markdown-edit/:id` |

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

### ç›®æ¨™
åœ¨ Protocol Guide çš„ Markdown ç·¨è¼¯å™¨ä¸­æ–°å¢**æ‘˜è¦å€å¡Šèªæ³•**åŠŸèƒ½ï¼Œè®“ç”¨æˆ¶å¯ä»¥ï¼š
1. åœ¨å·¦å´ç·¨è¼¯å€ä½¿ç”¨ç‰¹æ®Šèªæ³•å®šç¾©æ‘˜è¦å€å¡Š
2. åœ¨å³å´é è¦½å€å³æ™‚çœ‹åˆ°æ¸²æŸ“å¾Œçš„æ‘˜è¦å¡ç‰‡
3. **é»æ“Šæ‘˜è¦é …ç›®å¯è·³è½‰åˆ°å°æ‡‰çš„æ–‡æª”ä½ç½®**

### ä½¿ç”¨å ´æ™¯
- åœ¨é•·ç¯‡ Protocol æ–‡æª”é–‹é ­å»ºç«‹å°è¦½æ‘˜è¦
- å¿«é€Ÿæ¦‚è¦½æ–‡æª”çš„ä¸»è¦ç« ç¯€å’Œæ­¥é©Ÿ
- æä¾›å¯é»æ“Šçš„éŒ¨é»å°èˆªåŠŸèƒ½

---

## ğŸ“ èªæ³•è¦æ ¼

### æ¡ç”¨æ–¹æ¡ˆï¼š`:::` å®¹å™¨èªæ³•ï¼ˆæ–¹æ¡ˆ Aï¼‰

#### åŸºæœ¬èªæ³•
```markdown
::: summary æ‘˜è¦æ¨™é¡Œ
- [é …ç›®1 æ–‡å­—](#éŒ¨é»1)
- [é …ç›®2 æ–‡å­—](#éŒ¨é»2)
- [é …ç›®3 æ–‡å­—](#éŒ¨é»3)
:::
```

#### å®Œæ•´ç¯„ä¾‹
```markdown
::: summary AVL SOP å¿«é€Ÿå°è¦½
- [Chromebook NB è¨­å‚™æ¸…å–®](#chromebook-nb)
- [Chrome image ç‡’éŒ„æ­¥é©Ÿ](#chrome-image-ç‡’éŒ„)
- [å®˜ç¶²ä¸‹è¼‰ Image OS](#chorme-å®˜ç¶²ä¸‹è¼‰å°æ‡‰-image-os)
- [é€éæœå°‹è¨­å®šåƒæ•¸](#step3-é€éæœå°‹è¨­å®šåƒæ•¸)
:::

## Chromebook NB

NB-SSD-1685 (HP Elite c645 14 G2 )
NB-SSD-1910 (ACER Chromebook Spin 714 cp714)

## Chrome image ç‡’éŒ„

### Chorme å®˜ç¶²ä¸‹è¼‰å°æ‡‰ Image OS

Step.1 å®˜ç¶²é€£çµå¦‚ä¸‹
https://chromeos.google.com/partner/dlm/buildImages/list

...
```

### èªæ³•è¦å‰‡

| è¦å‰‡ | èªªæ˜ |
|------|------|
| é–‹å§‹æ¨™è¨˜ | `::: summary æ¨™é¡Œæ–‡å­—` |
| çµæŸæ¨™è¨˜ | `:::` |
| å…§å®¹æ ¼å¼ | æ”¯æ´ Markdown åˆ—è¡¨å’Œé€£çµèªæ³• |
| éŒ¨é»é€£çµ | ä½¿ç”¨ `[æ–‡å­—](#éŒ¨é»)` æ ¼å¼ |
| éŒ¨é»ç”Ÿæˆ | æ¨™é¡Œè‡ªå‹•ç”ŸæˆéŒ¨é»ï¼ˆä¸­æ–‡æ”¯æ´ï¼‰ |

### éŒ¨é»å‘½åè¦å‰‡

æ¨™é¡Œæœƒè‡ªå‹•è½‰æ›ç‚ºéŒ¨é» IDï¼š

| æ¨™é¡Œ | ç”Ÿæˆçš„éŒ¨é» ID |
|------|--------------|
| `## Chromebook NB` | `#chromebook-nb` |
| `## Chrome image ç‡’éŒ„` | `#chrome-image-ç‡’éŒ„` |
| `### Step.1 å®˜ç¶²é€£çµ` | `#step1-å®˜ç¶²é€£çµ` |

è½‰æ›è¦å‰‡ï¼š
1. è½‰ç‚ºå°å¯«
2. ç©ºæ ¼æ›¿æ›ç‚º `-`
3. ç§»é™¤ç‰¹æ®Šå­—å…ƒï¼ˆä¿ç•™ä¸­æ–‡ï¼‰
4. ç§»é™¤é–‹é ­çš„ `#` ç¬¦è™Ÿ

---

## ğŸ¨ UI è¨­è¨ˆ

### é è¦½å€æ¸²æŸ“æ¨£å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ AVL SOP å¿«é€Ÿå°è¦½                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â€¢ Chromebook NB è¨­å‚™æ¸…å–®      â† å¯é»æ“Š     â”‚
â”‚  â€¢ Chrome image ç‡’éŒ„æ­¥é©Ÿ       â† å¯é»æ“Š     â”‚
â”‚  â€¢ å®˜ç¶²ä¸‹è¼‰ Image OS           â† å¯é»æ“Š     â”‚
â”‚  â€¢ é€éæœå°‹è¨­å®šåƒæ•¸            â† å¯é»æ“Š     â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨£å¼è¦æ ¼

```css
.markdown-summary-block {
  /* å®¹å™¨æ¨£å¼ */
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
  border: 1px solid #bae6fd;
  border-left: 4px solid #0284c7;
  border-radius: 8px;
  margin: 16px 0;
  overflow: hidden;
}

.markdown-summary-header {
  /* æ¨™é¡Œæ¨£å¼ */
  background: rgba(2, 132, 199, 0.1);
  padding: 12px 16px;
  font-weight: 600;
  font-size: 16px;
  color: #0369a1;
  display: flex;
  align-items: center;
  gap: 8px;
}

.markdown-summary-header::before {
  content: 'ğŸ“‹';
}

.markdown-summary-content {
  /* å…§å®¹æ¨£å¼ */
  padding: 12px 16px;
}

.markdown-summary-content a {
  /* é€£çµæ¨£å¼ */
  color: #0284c7;
  text-decoration: none;
  transition: color 0.2s;
}

.markdown-summary-content a:hover {
  color: #0369a1;
  text-decoration: underline;
}

.markdown-summary-content li {
  /* åˆ—è¡¨é …ç›®æ¨£å¼ */
  margin: 8px 0;
  cursor: pointer;
}
```

### é»æ“Šè·³è½‰è¡Œç‚º

1. ç”¨æˆ¶é»æ“Šæ‘˜è¦ä¸­çš„é€£çµé …ç›®
2. å³å´é è¦½å€å¹³æ»‘æ»¾å‹•åˆ°å°æ‡‰çš„éŒ¨é»ä½ç½®
3. ç›®æ¨™å€å¡ŠçŸ­æš«é«˜äº®é¡¯ç¤ºï¼ˆå¯é¸ï¼‰

---

## ğŸ”§ æŠ€è¡“å¯¦ä½œè¦åŠƒ

### éœ€è¦ä¿®æ”¹çš„æª”æ¡ˆ

| æª”æ¡ˆè·¯å¾‘ | ä¿®æ”¹å…§å®¹ | ç‹€æ…‹ |
|---------|---------|------|
| `frontend/src/utils/markdownSummaryParser.js` | ğŸ†• æ–°å¢ - æ‘˜è¦èªæ³•è§£æå™¨ | âœ… å®Œæˆ |
| `frontend/src/components/editor/MarkdownEditorLayout.jsx` | æ•´åˆæ‘˜è¦è§£æã€CSS æ¨£å¼ã€éŒ¨é»è·³è½‰ | âœ… å®Œæˆ |

### å¯¦ä½œæ­¥é©Ÿ

#### Phase 1ï¼šæ‘˜è¦å€å¡Šè§£æèˆ‡æ¸²æŸ“

**Step 1.1ï¼šå»ºç«‹æ‘˜è¦èªæ³•è§£æå™¨**

```javascript
// frontend/src/utils/markdownParser.js

/**
 * è§£ææ‘˜è¦å€å¡Šèªæ³•
 * å°‡ ::: summary æ¨™é¡Œ ... ::: è½‰æ›ç‚º HTML
 */
export const parseSummaryBlocks = (markdown) => {
  // æ­£å‰‡è¡¨é”å¼åŒ¹é… ::: summary ... :::
  const summaryRegex = /^:::\s*summary\s+(.+?)\n([\s\S]*?)^:::/gm;
  
  return markdown.replace(summaryRegex, (match, title, content) => {
    // è§£æå…§å®¹ä¸­çš„ Markdown åˆ—è¡¨å’Œé€£çµ
    const parsedContent = parseMarkdownList(content);
    
    return `
      <div class="markdown-summary-block">
        <div class="markdown-summary-header">${escapeHtml(title)}</div>
        <div class="markdown-summary-content">${parsedContent}</div>
      </div>
    `;
  });
};

/**
 * è§£æ Markdown åˆ—è¡¨èªæ³•
 */
const parseMarkdownList = (content) => {
  // è™•ç†åˆ—è¡¨é …ç›®å’Œé€£çµ
  // - [æ–‡å­—](#éŒ¨é») => <li><a href="#éŒ¨é»">æ–‡å­—</a></li>
};
```

**Step 1.2ï¼šæ•´åˆåˆ° MarkdownEditorPage**

```javascript
// frontend/src/pages/MarkdownEditorPage.js

import { parseSummaryBlocks } from '../utils/markdownParser';

// åœ¨æ¸²æŸ“é è¦½æ™‚å…ˆè™•ç†æ‘˜è¦å€å¡Š
const renderPreview = (content) => {
  // 1. å…ˆè§£ææ‘˜è¦å€å¡Š
  let processedContent = parseSummaryBlocks(content);
  
  // 2. å†ç”¨æ¨™æº– Markdown æ¸²æŸ“å™¨è™•ç†å…¶ä»–å…§å®¹
  return markdownRenderer.render(processedContent);
};
```

**Step 1.3ï¼šæ·»åŠ  CSS æ¨£å¼**

```css
/* frontend/src/pages/MarkdownEditorPage.css */

/* æ‘˜è¦å€å¡Šæ¨£å¼ - å¦‚ä¸Šæ–¹æ¨£å¼è¦æ ¼æ‰€ç¤º */
```

#### Phase 2ï¼šéŒ¨é»è·³è½‰åŠŸèƒ½

**Step 2.1ï¼šè‡ªå‹•ç”Ÿæˆæ¨™é¡ŒéŒ¨é»**

```javascript
/**
 * ç‚ºæ‰€æœ‰æ¨™é¡Œç”ŸæˆéŒ¨é» ID
 */
export const generateHeadingAnchors = (markdown) => {
  // å°‡ ## æ¨™é¡Œ è½‰æ›ç‚º <h2 id="éŒ¨é»">æ¨™é¡Œ</h2>
  const headingRegex = /^(#{1,6})\s+(.+)$/gm;
  
  return markdown.replace(headingRegex, (match, hashes, title) => {
    const level = hashes.length;
    const anchorId = generateAnchorId(title);
    return `<h${level} id="${anchorId}">${title}</h${level}>`;
  });
};

/**
 * ç”ŸæˆéŒ¨é» ID
 * "Chrome image ç‡’éŒ„" => "chrome-image-ç‡’éŒ„"
 */
const generateAnchorId = (title) => {
  return title
    .toLowerCase()
    .trim()
    .replace(/\s+/g, '-')           // ç©ºæ ¼è½‰ç‚º -
    .replace(/[^\w\u4e00-\u9fa5-]/g, ''); // ä¿ç•™è‹±æ•¸å­—ã€ä¸­æ–‡ã€-
};
```

**Step 2.2ï¼šå¯¦ä½œå¹³æ»‘æ»¾å‹•**

```javascript
/**
 * è™•ç†æ‘˜è¦é€£çµé»æ“Šäº‹ä»¶
 */
const handleSummaryLinkClick = (e) => {
  const href = e.target.getAttribute('href');
  if (href && href.startsWith('#')) {
    e.preventDefault();
    const targetId = href.slice(1);
    const targetElement = document.getElementById(targetId);
    
    if (targetElement) {
      // å¹³æ»‘æ»¾å‹•åˆ°ç›®æ¨™ä½ç½®
      targetElement.scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
      
      // å¯é¸ï¼šçŸ­æš«é«˜äº®ç›®æ¨™å€å¡Š
      targetElement.classList.add('highlight-anchor');
      setTimeout(() => {
        targetElement.classList.remove('highlight-anchor');
      }, 2000);
    }
  }
};
```

---

## ğŸ“Š å·¥ä½œé‡é ä¼°

| éšæ®µ | å·¥ä½œé …ç›® | é ä¼°æ™‚é–“ |
|------|---------|---------|
| Phase 1 | æ‘˜è¦å€å¡Šè§£æèˆ‡æ¸²æŸ“ | 2-3 å°æ™‚ |
| Phase 2 | éŒ¨é»è·³è½‰åŠŸèƒ½ | 1-2 å°æ™‚ |
| æ¸¬è©¦ | åŠŸèƒ½æ¸¬è©¦èˆ‡èª¿æ•´ | 1 å°æ™‚ |
| **ç¸½è¨ˆ** | | **4-6 å°æ™‚** |

---

## âœ… é©—æ”¶æ¨™æº–

### åŠŸèƒ½é©—æ”¶

- [ ] åœ¨ç·¨è¼¯å€è¼¸å…¥ `::: summary æ¨™é¡Œ ... :::` èªæ³•
- [ ] å³å´é è¦½å€æ­£ç¢ºé¡¯ç¤ºæ‘˜è¦å¡ç‰‡
- [ ] æ‘˜è¦å¡ç‰‡æ¨£å¼ç¬¦åˆè¨­è¨ˆè¦æ ¼
- [ ] é»æ“Šæ‘˜è¦ä¸­çš„é€£çµå¯è·³è½‰åˆ°å°æ‡‰ä½ç½®
- [ ] è·³è½‰å‹•ç•«å¹³æ»‘æµæš¢
- [ ] æ”¯æ´ä¸­æ–‡æ¨™é¡Œå’ŒéŒ¨é»

### ç›¸å®¹æ€§é©—æ”¶

- [ ] ä¸å½±éŸ¿ç¾æœ‰ Markdown èªæ³•è§£æ
- [ ] ä¸å½±éŸ¿åœ–ç‰‡ä¸Šå‚³å’Œé¡¯ç¤ºåŠŸèƒ½
- [ ] åœ¨ä¸åŒç€è¦½å™¨ä¸­è¡¨ç¾ä¸€è‡´ï¼ˆChromeã€Firefoxã€Edgeï¼‰

---

## ğŸ”„ å¾ŒçºŒæ“´å±•ï¼ˆæœªä¾†è€ƒæ…®ï¼‰

| åŠŸèƒ½ | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| æŠ˜ç–Š/å±•é–‹ | æ‘˜è¦å€å¡Šå¯æŠ˜ç–Š | ä½ |
| å¤šç¨®å€å¡Šé¡å‹ | æ”¯æ´ warningã€infoã€tip ç­‰ | ä¸­ |
| è‡ªå‹•ç”Ÿæˆæ‘˜è¦ | æ ¹æ“šæ¨™é¡Œè‡ªå‹•ç”Ÿæˆæ‘˜è¦å€å¡Š | ä¸­ |
| ç·¨è¼¯å™¨å·¥å…·æ¬„æŒ‰éˆ• | ä¸€éµæ’å…¥æ‘˜è¦èªæ³•æ¨¡æ¿ | ä¸­ |

---

## ğŸ“š åƒè€ƒè³‡æ–™

- [Markdown Container Syntax](https://github.com/markdown-it/markdown-it-container)
- [GitHub Flavored Markdown](https://github.github.com/gfm/)
- ç¾æœ‰å¯¦ä½œåƒè€ƒï¼š`frontend/src/pages/MarkdownEditorPage.js`

---

**ğŸ“… æ›´æ–°æ—¥æœŸ**: 2025-12-08  
**âœï¸ ä½œè€…**: AI Platform Team  
**ğŸ¯ ç‹€æ…‹**: âœ… å·²å®Œæˆ

## ğŸ“¦ å¯¦éš›ä¿®æ”¹æª”æ¡ˆæ¸…å–®

### 1. æ–°å¢æª”æ¡ˆ
- `frontend/src/utils/markdownSummaryParser.js` - æ‘˜è¦å€å¡Šè§£æå™¨

### 2. ä¿®æ”¹æª”æ¡ˆ
- `frontend/src/components/editor/MarkdownEditorLayout.jsx`
  - å°å…¥ `markdownSummaryParser` å·¥å…·
  - ä¿®æ”¹ `renderMarkdownWithImages` å‡½æ•¸ï¼Œæ•´åˆæ‘˜è¦è§£æå’ŒéŒ¨é»ç”Ÿæˆ
  - æ·»åŠ æ‘˜è¦å€å¡Š CSS æ¨£å¼åˆ° `customToolbarStyles`
  - æ·»åŠ æ‘˜è¦é€£çµé»æ“Šäº‹ä»¶è™•ç† `useEffect`
